<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>NYC Map</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
  <style>
    :root {
      --panel-bg: #f4f4f4;
      --panel-hover: #eaeaea;
      --shadow: 0 4px 12px rgba(0,0,0,0.15);
      --radius: 12px;
      --transition: 0.3s ease;
      --font: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
    }

    html, body {
      margin: 0;
      padding: 0;
      height: 100%;
      width: 100%;
      font-family: var(--font);
      background-color: #fff;
    }

    #map { height: 100vh; width: 100%; }

    .version-box {
      position: absolute;
      top: 10px;
      right: 10px;
      background: white;
      padding: 8px 14px;
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      font-weight: 600;
      font-size: 14px;
      z-index: 1000;
    }

    /* Collapsible panel */
    #location-container {
      position: absolute;
      top: 50px;
      right: 10px;
      width: 220px;
      max-height: 70vh;
      background: var(--panel-bg);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      overflow: hidden;
      transition: height var(--transition);
      z-index: 1000;
      display: flex;
      flex-direction: column;
    }

    #searchBox {
      width: 100%;
      padding: 10px;
      border: none;
      border-bottom: 1px solid #ccc;
      border-radius: var(--radius) var(--radius) 0 0;
      background: var(--panel-bg);
      font-size: 15px;
      outline: none;
    }

    #locationList {
      display: none;
      overflow-y: auto;
      flex: 1;
    }

    .location-item {
      cursor: pointer;
      padding: 8px 10px;
      font-size: 14px;
      border-bottom: 1px solid #ddd;
      transition: background var(--transition);
    }

    .location-item:hover {
      background-color: var(--panel-hover);
    }

    @media (max-width: 600px) {
      #location-container {
        width: 180px;
        top: 60px;
        right: 10px;
      }
      .version-box {
        font-size: 12px;
        padding: 6px 10px;
      }
    }
  </style>
</head>
<body>
<div id="map"></div>
<div class="version-box" id="versionBox"></div>

<div id="location-container">
  <input type="text" id="searchBox" placeholder="Search location...">
  <div id="locationList"></div>
</div>

<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
<script>
// ---------------------------
// Version info (change only here)
var mapDate = "17 October 2025";
var mapVersion = 2.4;
// ---------------------------

document.getElementById("versionBox").innerText = "Map Version: " + mapDate + " (v" + mapVersion + ")";

var map = L.map('map').setView([40.7851, -73.9683], 12); // Centered at Central Park
L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
  attribution: '&copy; OpenStreetMap contributors'
}).addTo(map);

// Marker icons
var icons = {
  hotel: L.icon({iconUrl:'https://maps.google.com/mapfiles/ms/icons/red-dot.png', iconSize:[32,32]}),
  sight: L.icon({iconUrl:'https://maps.google.com/mapfiles/ms/icons/green-dot.png', iconSize:[32,32]}),
  food: L.icon({iconUrl:'https://maps.google.com/mapfiles/ms/icons/orange-dot.png', iconSize:[32,32]}),
  rooftop: L.icon({iconUrl:'https://maps.google.com/mapfiles/ms/icons/purple-dot.png', iconSize:[32,32]}),
  subway: L.icon({iconUrl:'https://maps.google.com/mapfiles/ms/icons/blue-dot.png', iconSize:[28,28]})
};

// Locations
var locations = {
  "The Lexington Hotel": {coords:[40.7561,-73.9725], type:"hotel"},
  "Times Square":[40.7580,-73.9855,"sight"],
  "Central Park":[40.7851,-73.9683,"sight"],
  "Union Square":[40.7359,-73.9911,"sight"],
  "Bryant Park":[40.7536,-73.9832,"sight"],
  "Rockefeller Center":[40.7587,-73.9787,"sight"],
  "Empire State Building":[40.7484,-73.9857,"sight"],
  "Brooklyn Bridge":[40.7061,-73.9969,"sight"],
  "The Met":[40.7794,-73.9632,"sight"],
  "Wall Street â€“ Bull & NYSE":[40.7075,-74.0113,"sight"],
  "9/11 Memorial":[40.7115,-74.0134,"sight"],
  "Chelsea Market":[40.7424,-74.0060,"sight"],
  "Hudson Yards":[40.7540,-74.0020,"sight"],
  "Flat Iron Building":[40.7411,-73.9897,"sight"],
  // Subway stations
  "Fulton St Subway":[40.7104,-74.0072,"subway"],
  "Bowling Green":[40.7040,-74.0134,"subway"],
  "South Ferry":[40.7013,-74.0132,"subway"]
};

// Add markers
var markers = {};
for (var key in locations) {
  var loc = locations[key];
  var coords = loc.coords || [loc[0], loc[1]];
  var type = loc.type || loc[2] || "sight";
  var marker = L.marker(coords, {icon: icons[type]}).bindPopup(key).addTo(map);
  markers[key] = marker;
}

// Populate list
var listContainer = document.getElementById("locationList");
for (var key in locations) {
  var item = document.createElement("div");
  item.className = "location-item";
  item.innerText = key;
  item.onclick = (function(k) {
    return function() {
      map.setView(markers[k].getLatLng(), 16);
      markers[k].openPopup();
    };
  })(key);
  listContainer.appendChild(item);
}

// Expand/collapse list
const searchBox = document.getElementById("searchBox");
const list = document.getElementById("locationList");
searchBox.addEventListener("focus", () => { list.style.display = "block"; });
searchBox.addEventListener("blur", () => {
  setTimeout(() => { list.style.display = "none"; }, 200);
});

// Filter search results
searchBox.addEventListener("input", function() {
  const filter = this.value.toLowerCase();
  const items = document.getElementsByClassName("location-item");
  for (let i=0; i<items.length; i++) {
    if (items[i].innerText.toLowerCase().includes(filter)) {
      items[i].style.display = "";
    } else {
      items[i].style.display = "none";
    }
  }
});
</script>
</body>
</html>
