<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>NYC Map 20/11/2025 (v4.8)</title>
<link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
<style>
  body, html { margin:0; padding:0; height:100%; font-family: Arial, sans-serif; }
  #map { height:100%; width:100%; }
  #panel {
    position:absolute; top:10px; right:10px; width:260px; background:white;
    padding:10px; border-radius:8px; box-shadow:0 2px 5px rgba(0,0,0,0.3); z-index:1000;
  }
  #panelHeader { font-weight:bold; cursor:pointer; }
  #searchBox {
    width:100%; padding:6px; margin:8px 0; font-size:14px;
    border:1px solid #ccc; border-radius:5px; background:white;
  }
  #listContainer { max-height:300px; overflow-y:auto; }
  .category { font-weight:bold; margin-top:10px; border-bottom:1px solid #ccc; padding-bottom:3px; }
  .item { padding:5px; cursor:pointer; border-bottom:1px solid #eee; }
  .item:hover { background:#f7f7f7; }
  #routeInfo {
    position:absolute; bottom:10px; left:50%; transform:translateX(-50%);
    background:white; padding:8px 12px; border-radius:8px;
    box-shadow:0 2px 5px rgba(0,0,0,0.3); z-index:1000;
    font-size:14px;
  }
  @media (max-width: 768px) {
    #panel { width: 90%; right: 5%; top: 10px; }
    #routeInfo { font-size:12px; bottom:15px; }
  }
</style>
</head>
<body>
<div id="map"></div>
<div id="panel">
  <div id="panelHeader">Locations ▼</div>
  <input id="searchBox" placeholder="Search..." />
  <div>
    <input type="checkbox" id="toggleSubway" checked /> Show Subway Stations
  </div>
  <div id="listContainer"></div>
</div>
<div id="routeInfo">Select a location to see distance & walking time</div>

<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
<script>
const map = L.map('map').setView([40.785091, -73.968285], 13);
L.tileLayer('https://{s}.tile.openstreetmap.fr/hot/{z}/{x}/{y}.png', {
  attribution: '&copy; OpenStreetMap contributors'
}).addTo(map);

const icons = {
  subway: L.icon({iconUrl:'https://maps.google.com/mapfiles/ms/icons/blue-dot.png', iconSize:[28,28]}),
  sight: L.icon({iconUrl:'https://maps.google.com/mapfiles/ms/icons/green-dot.png', iconSize:[28,28]}),
  food: L.icon({iconUrl:'https://maps.google.com/mapfiles/ms/icons/orange-dot.png', iconSize:[28,28]}),
  rooftop: L.icon({iconUrl:'https://maps.google.com/mapfiles/ms/icons/purple-dot.png', iconSize:[28,28]}),
  me: L.icon({iconUrl:'https://maps.google.com/mapfiles/ms/icons/blue.png', iconSize:[24,24]})
};

// Current location (Central Park)
const currentLocation = [40.785091, -73.968285];
L.marker(currentLocation, {icon: icons.me}).addTo(map).bindPopup("You are here");

// Locations (Sights, Food, Rooftops)
const locations = {
  "Times Square": ["sight",[40.7580,-73.9855]],
  "Central Park": ["sight",[40.7851,-73.9683]],
  "Bryant Park": ["sight",[40.7536,-73.9832]],
  "Rockefeller Center": ["sight",[40.7587,-73.9787]],
  "Empire State Building": ["sight",[40.7484,-73.9857]],
  "Highline": ["sight",[40.7480,-74.0048]],
  "The Met": ["sight",[40.7794,-73.9632]],
  "Flat Iron Building": ["sight",[40.7411,-73.9897]],
  "Grand Central Station": ["sight",[40.7527,-73.9772]],
  "9/11 Memorial": ["sight",[40.7115,-74.0134]],
  "Brooklyn Bridge": ["sight",[40.7061,-73.9969]],
  "Hudson Yards": ["sight",[40.7540,-74.0020]],
  "Statue of Liberty": ["sight",[40.6892,-74.0445]],
  "Wall Street – Bull & NYSE": ["sight",[40.7075,-74.0113]],
  
  // Rooftops
  "Le Bain": ["rooftop",[40.7416,-74.0072]],
  "The Public": ["rooftop",[40.7278,-74.0020]],
  "Darling Rooftop Bar and Lounge": ["rooftop",[40.7644,-73.9768]],

  // Food & Drinks
  "Blue Bottle": ["food",[40.7410,-73.9887]],
  "Tompkins Bagels": ["food",[40.7282,-73.9911]],
  "Black Seed Bagels": ["food",[40.7230,-73.9973]],
  "Chipotle": ["food",[40.7591,-73.9840]],
  "Baby Luc's (Pizza)": ["food",[40.6761,-73.9981]]
};

// Manhattan Subway Stations (top 10 for example)
const subwayStations = {
  "South Ferry": [40.701309, -74.013119],
  "Bowling Green": [40.704288, -74.014027],
  "Fulton St": [40.710374, -74.007582],
  "Chambers St": [40.714111, -74.009039],
  "Canal St": [40.719527, -74.006735],
  "Houston St": [40.728226, -73.995623],
  "14th St": [40.737826, -74.000236],
  "34th St - Herald Sq": [40.749567, -73.987950],
  "42nd St - Times Sq": [40.755290, -73.987495],
  "59th St - Columbus Circle": [40.768044, -73.981893]
};

// Merge subway stations into locations
Object.entries(subwayStations).forEach(([name, coords])=>{
  locations[name] = ["subway", coords];
});

const markers = {};
const listContainer = document.getElementById('listContainer');

Object.entries(locations).forEach(([name, [type, coords]]) => {
  const marker = L.marker(coords, {icon: icons[type]}).bindPopup(name).addTo(map);
  markers[name] = marker;

  const div = document.createElement('div');
  div.className = 'item';
  div.innerText = name;
  div.onclick = () => selectLocation(name);
  listContainer.appendChild(div);
});

// Search filter
document.getElementById('searchBox').addEventListener('input', function(){
  const query = this.value.toLowerCase();
  document.querySelectorAll('.item').forEach(item => {
    item.style.display = item.innerText.toLowerCase().includes(query) ? 'block' : 'none';
  });
});

// Toggle Subway
document.getElementById('toggleSubway').addEventListener('change', function(){
  const show = this.checked;
  Object.entries(locations).forEach(([name,[type]])=>{
    if(type === "subway"){
      show ? map.addLayer(markers[name]) : map.removeLayer(markers[name]);
    }
  });
});

// Selection + distance/time
function selectLocation(name){
  const marker = markers[name];
  map.setView(marker.getLatLng(), 15);
  marker.openPopup();
  const dist = map.distance(currentLocation, marker.getLatLng()) / 1000;
  const walkTime = Math.round((dist / 5) * 60);
  document.getElementById('routeInfo').innerText =
    `${name} — Distance: ${dist.toFixed(2)} km | Est. walk: ${walkTime} min`;
}

// Collapse panel
let collapsed = false;
document.getElementById('panelHeader').addEventListener('click', ()=>{
  collapsed = !collapsed;
  document.getElementById('listContainer').style.display = collapsed ? 'none' : 'block';
  document.getElementBy
